# From a fresh Ubuntu droplet
# install git jq cpanminus parallel make unzip screen

# install recordstream with cpanm --interactive App::RecordStream, say no to all options
# git clone https://github.com/andreafabrizi/Dropbox-Uploader
# Process open.fda.gov data files from JSON to CSV
# dbuijs@gmail.com
# Uses jq (v1.5), perl RecordStream

Command to download and unzip all files

curl https://api.fda.gov/download.json/?search= | jq -r '.results.drug.event.partitions[].file' | parallel --progress ./fdadl
# Optional to filter by year
curl https://api.fda.gov/download.json/?search= | jq -r '.results.drug.event.partitions[].file|select(contains("2005"))'


Command to process all files that end with .json

parallel --progress 'echo Starting {1} {2}; cat {1} | jq -c -f {2} | recs-tocsv > {1.}.{2.}.csv' ::: *.json.zip ::: *.jq


http://download.open.fda.gov/drug/event/2005q1/drug-event-0001-of-0001.json.zip
